<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<title>MailFilter professional: Cluster Support</title>
	<style>
	P,TD,A,BODY { font-family : Verdana, Geneva, Arial, Helvetica, sans-serif; font-size : 9pt; font-variant : normal; line-height : 130%; color: black; background-color: white; }
	h1 { line-height: 100%; font-size: 24pt; font-weight: bold; margin: 0 0 0 0; padding: 0 0 0 0; }
	h2 { font-size: 17pt; }
	body { padding-left: 10px; padding-right: 10px; padding-top: 0px; border: 0 0 0 0; margin: 0 0 0 0; }
	pre { border: 1px solid red; padding: 4px 4px 4px 4px; margin-left: 10px; margin-right: 40px; }
	</style>
</head>
<body><table width=600 align=center valign=top style="border: 1px solid black;" cellspacing=0 cellpadding=0>
	<tr><td><a href="http://www.mailfilter.cc/"><img src="mailfilter-notes.png" border="0"></a></td></tr>
	<tr><td style="padding-left: 5px;"><br><h1>Cluster Support</h1></td></tr>
	<tr><td style="padding-left: 5px; padding-right: 5px;">

<b>Version 1.5</b><br>
<br>

<h2>Features</h2>
<ul>
	<li>MailFilter does not need to be installed on SYS: - it can reside on any volume.</li>	
	<li>You can customize MFSTOP.NCF in a way that unloading MailFilterx on one server migrates the Cluster Application to another server.</li>
	<li>Every MailFilter NLM supports specifying the configuration directory on the command line.<br>
	For example: load mailflt.nlm gwise:\mailfilter</li>
</ul>

<h3>Installation Example</h3>
This instruction assumes that your shared cluster volume is named "GWISE" and the shared IP address is "192.168.130.215".

<ol>
<li>Install GroupWise and GWIA as normal and create your shared cluster volume.

<li>Install MailFilter to your workstation.

<li>Create GWISE:\MAILFLT and GWISE:\SYSTEM directories.

<li>Copy everything from C:\Programme\MailFilter\NLM\SYSTEM to GWISE:\SYSTEM

<li>Copy everything from C:\Programme\MailFilter\NLM\ETC to GWISE:\MAILFLT

<li>Rename GWISE:\MAILFLT\CONFIG.NUL to CONFIG.BIN

<li>Initial MailFilter configuration:<br>
	<code>
       SEARCH ADD GWISE:\SYSTEM<br>
       LOAD MFUPGR.NLM GWISE:\MAILFLT
	</code><br>
    Switch to the logger screen and check for errors, if ok then load MFConfig:
	<code>
       LOAD MFCONFIG.NLM GWISE:\MAILFLT
	</code><br>
    Fill in your configuration and verify that the filter list has been imported, if not, do it now. (You already copied the default filters to GWISE:\MAILFLT\FILTERS.BIN in Step 5.)<br>
    When done, load MAILFLT.NLM GWISE:\MAILFLT and check it works.

<li>Change your MFSTART.NCF:<br>
     a) Add "SEARCH ADD GWISE:\SYSTEM" before the first line.<br>
     b) Comment out the "MFSTOP" line.<br>
     c) Comment out "load mailflt" and uncomment the "load address space ..." line.<br>
     d) Apped "GWISE:\MAILFLT" to the "load address space ..." line.

<li>Change your MFSTOP.NCF:<br>
     Comment out the "unload mailflt.nlm" line.

<li>Add the following to your Cluster Object Load Script:<br>
     <code>GWISE:\SYSTEM\mfstart.ncf</code>

<li>Add the following to your Cluster Object Unload Script:<br>
     <code>GWISE:\SYSTEM\mfstop.ncf</code>

<li>Make sure you have unloaded MailFilter and all related NLMs.<br>
    You can try out your newly clustered MailFilter now.

</ol>

<h3>Sample Scripts</h3>
<b>Cluster Resource Load Script</b><br>
<pre>
search add gwise:\system

add secondary ipaddress 192.168.130.215
CLUSTER CVSBIND ADD CLUSTER_GWISEPOOL_SERVER 192.168.130.215
NUDP ADD CLUSTER_GWISEPOOL_SERVER 192.168.130.215
nss /poolactivate=GWISEPOOL /overridetype=question
mount GWISE
  
gwise:\system\mfstart.ncf
</pre>
<br>

<b>Cluster Resource Unload Script</b><br>
<pre>
gwise:\system\mfstop.ncf

del secondary ipaddress 192.168.130.215
CLUSTER CVSBIND DEL CLUSTER_GWISEPOOL_SERVER 192.168.130.215
NUDP DEL CLUSTER_GWISEPOOL_SERVER 192.168.130.215
nss /pooldeactivate=GWISEPOOL /overridetype=question
</pre>
<br>

<b>MailFilter Startup: MFSTART.NCF</b><br>
<pre>
##
## MFSTART.NCF - Starts the MailFilter System.
##
#
search add gwise:\system
#######
## Load MailFilter Server/NLM
## This is the main component of MailFilter on NetWare.
load address space = MailFilter mailflt gwise:\mailflt
#######
#
##
## --- e o f ---
##
</pre>
<br>

<b>MailFilter Unload: MFSTOP.NCF</b><br>
<pre>
##
## MFSTOP.NCF - Shuts down MailFilter System.
##
#
#######
## Unload MailFilter Server
unload address space = mailfilter
unload address space = mailflt
#######
#
##
## --- e o f ---
##
</pre>
<br>

</td>
</tr>
</table>
</body>
</html>
